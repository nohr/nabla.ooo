"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("postprocessing"),t=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),r=require("react"),n=require("three"),o=require("@babel/runtime/helpers/extends"),i=require("@babel/runtime/helpers/construct"),u=require("@react-three/fiber");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=a(t),c=a(r),l=a(o),s=a(i),d=["blendFunction","opacity"],p=function(t,n){return void 0===n&&(n=e.BlendFunction.NORMAL),r.forwardRef((function(e,o){var i=e.blendFunction,u=e.opacity,a=f.default(e,d),l=r.useMemo((function(){return new t(a)}),[a]);return r.useLayoutEffect((function(){l.blendMode.blendFunction=i||n,void 0!==u&&(l.blendMode.opacity.value=u)}),[i,l.blendMode,u]),c.default.createElement("primitive",{ref:o,object:l,dispose:null})}))},m=function(e,t){var o=e[t];return r.useMemo((function(){if(o instanceof n.Vector2)return(new n.Vector2).set(o.x,o.y);if(Array.isArray(o)){var e=o[0],t=o[1];return(new n.Vector2).set(e,t)}}),[o])},v=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},h=p(e.BloomEffect,e.BlendFunction.SCREEN),E=p(e.BrightnessContrastEffect),x=r.forwardRef((function(t,n){var o=m(t,"offset"),i=r.useMemo((function(){return new e.ChromaticAberrationEffect(l.default({},t,{offset:o}))}),[o,t]);return c.default.createElement("primitive",{ref:n,object:i,dispose:null})})),g=r.forwardRef((function(t,n){var o=t.blendFunction,i=void 0===o?e.BlendFunction.NORMAL:o,u=r.useMemo((function(){return new e.ColorAverageEffect(i)}),[i]);return c.default.createElement("primitive",{ref:n,object:u,dispose:null})})),b=p(e.ColorDepthEffect),w=p(e.DepthEffect),S=r.createContext(null),y=c.default.memo(r.forwardRef((function(t,n){var o=t.children,i=t.camera,a=t.scene,f=t.renderPriority,l=void 0===f?1:f,d=t.autoClear,p=void 0===d||d,m=t.depthBuffer,h=t.disableNormalPass,E=void 0===h||h,x=t.stencilBuffer,g=t.multisampling,b=void 0===g?0:g,w=t.frameBufferType,y=u.useThree(),C=y.gl,M=y.scene,R=y.camera,L=y.size;a=a||M,i=i||R;var A=r.useMemo((function(){var t=new e.EffectComposer(C,{depthBuffer:m,stencilBuffer:x,multisampling:v()?b:0,frameBufferType:w});t.addPass(new e.RenderPass(a,i));var r=E?null:new e.NormalPass(a,i);return r&&t.addPass(r),[t,r]}),[i,C,m,x,b,w,a,E]),T=A[0],B=A[1];r.useEffect((function(){return null==T?void 0:T.setSize(L.width,L.height)}),[T,L]),u.useFrame((function(e,t){return C.autoClear=p,void T.render(t)}),l);var F=r.useRef(null);r.useEffect((function(){var t;return F.current&&F.current.__r3f&&T&&(t=s.default(e.EffectPass,[i].concat(F.current.__r3f.objects)),T.addPass(t),t.renderToScreen=!0),function(){t&&(null==T||T.removePass(t))}}),[T,o,i]);var P=r.useMemo((function(){return{composer:T,normalPass:B,camera:i,scene:a}}),[T,B,i,a]);return r.useImperativeHandle(n,(function(){return T}),[T]),c.default.createElement(S.Provider,{value:P},c.default.createElement("group",{ref:F},o))}))),C=["target","depthTexture"],M=r.forwardRef((function(t,o){var i=t.target,u=t.depthTexture,a=f.default(t,C),l=r.useContext(S).camera,s=r.useMemo((function(){return new e.DepthOfFieldEffect(l,a)}),[l,a]);return r.useLayoutEffect((function(){if(i){var e=i instanceof n.Vector3?(new n.Vector3).set(i.x,i.y,i.z):(new n.Vector3).set(i[0],i[1],i[2]);s.target=e}u&&s.setDepthTexture(u.texture,u.packing)}),[i,u,s]),c.default.createElement("primitive",{ref:o,object:s,dispose:null})})),R=p(e.DotScreenEffect),L=["active"],A=r.forwardRef((function(t,n){var o=t.active,i=void 0===o||o,u=f.default(t,L),a=m(u,"delay"),s=m(u,"duration"),d=m(u,"strength"),p=r.useMemo((function(){return new e.GlitchEffect(l.default({},u,{delay:a,duration:s,strength:d}))}),[a,s,u,d]);return r.useLayoutEffect((function(){p.mode=i?u.mode||e.GlitchMode.SPORADIC:e.GlitchMode.DISABLED}),[i,p,u.mode]),c.default.createElement("primitive",{ref:n,object:p,dispose:null})})),T=r.forwardRef((function(t,n){var o=r.useContext(S).camera,i=r.useMemo((function(){return new e.GodRaysEffect(o,t.sun,t)}),[o,t]);return c.default.createElement("primitive",{ref:n,object:i,dispose:null})})),B=["size"],F=r.forwardRef((function(t,n){var o=t.size,i=f.default(t,B),u=r.useMemo((function(){return new e.GridEffect(i)}),[i]);return r.useLayoutEffect((function(){o&&u.setSize(o.width,o.height)}),[u,o]),c.default.createElement("primitive",{ref:n,object:u,dispose:null})})),P=p(e.HueSaturationEffect),j=p(e.NoiseEffect,e.BlendFunction.COLOR_DODGE),O=["selection","selectionLayer","blendFunction","patternTexture","edgeStrength","pulseSpeed","visibleEdgeColor","hiddenEdgeColor","width","height","kernelSize","blur","xRay"],D=r.forwardRef((function(t,n){var o=t.selection,i=void 0===o?[]:o,u=t.selectionLayer,a=void 0===u?10:u,l=t.blendFunction,s=t.patternTexture,d=t.edgeStrength,p=t.pulseSpeed,m=t.visibleEdgeColor,v=t.hiddenEdgeColor,h=t.width,E=t.height,x=t.kernelSize,g=t.blur,b=t.xRay;f.default(t,O);var w=r.useContext(S),y=w.scene,C=w.camera,M=r.useMemo((function(){return new e.OutlineEffect(y,C,{blendFunction:l,patternTexture:s,edgeStrength:d,pulseSpeed:p,visibleEdgeColor:m,hiddenEdgeColor:v,width:h,height:E,kernelSize:x,blur:g,xRay:b})}),[l,g,C,d,E,v,x,s,p,y,m,h,b]);return r.useEffect((function(){M.clearSelection(),M.setSelection(Array.isArray(i)?i.map((function(e){return e.current})):[i.current])}),[M,i]),r.useEffect((function(){M.selectionLayer=a}),[M,a]),c.default.createElement("primitive",{ref:n,object:M,dispose:null})})),G=r.forwardRef((function(t,n){var o=t.granularity,i=void 0===o?5:o,u=r.useMemo((function(){return new e.PixelationEffect(i)}),[i]);return c.default.createElement("primitive",{ref:n,object:u,dispose:null})})),z=p(e.ScanlineEffect,e.BlendFunction.OVERLAY),I=r.forwardRef((function(t,n){var o=t.selection,i=void 0===o?[]:o,u=t.selectionLayer,a=void 0===u?10:u,f=t.lights,l=void 0===f?[]:f,s=t.luminanceThreshold,d=t.luminanceSmoothing,p=t.intensity,m=t.width,v=t.height,h=t.kernelSize;0===l.length&&console.warn("SelectiveBloom requires lights to work.");var E=r.useContext(S),x=E.scene,g=E.camera,b=r.useMemo((function(){return new e.SelectiveBloomEffect(x,g,{blendFunction:e.BlendFunction.SCREEN,luminanceThreshold:s,luminanceSmoothing:d,intensity:p,width:m,height:v,kernelSize:h})}),[g,v,p,h,d,s,x,m]);return r.useEffect((function(){b.selection.set(Array.isArray(i)?i.map((function(e){return e.current})):[i.current])}),[b,i]),r.useEffect((function(){b.selection.layer=a}),[b,a]),r.useEffect((function(){return l.forEach((function(e){return function(e,t){e.current&&e.current.layers.enable(t.selection.layer)}(e,b)})),function(){return l.forEach((function(e){return function(e,t){e.current&&e.current.layers.disable(t.selection.layer)}(e,b)}))}}),[b,l,a]),c.default.createElement("primitive",{ref:n,object:b,dispose:null})})),k=p(e.SepiaEffect),N=r.forwardRef((function(t,n){var o=r.useContext(S),i=o.camera,u=o.normalPass,a=r.useMemo((function(){return null===u?(console.error("Please enable the NormalPass in the EffectComposer in order to use SSAO."),null):new e.SSAOEffect(i,u.renderTarget.texture,l.default({blendFunction:e.BlendFunction.MULTIPLY,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,scale:.5,bias:.5},t))}),[i,u,t]);return c.default.createElement("primitive",{ref:n,object:a,dispose:null})})),V=r.forwardRef((function(t,n){var o=t.preset,i=void 0===o?e.SMAAPreset.HIGH:o,a=t.edgeDetectionMode,f=void 0===a?e.EdgeDetectionMode.COLOR:a,l=u.useLoader(e.SMAAImageLoader,""),d=r.useMemo((function(){return s.default(e.SMAAEffect,l.concat([i,f]))}),[l,i,f]);return c.default.createElement("primitive",{ref:n,object:d,dispose:null})})),q=["textureSrc","texture"],_=r.forwardRef((function(t,o){var i=t.textureSrc,a=t.texture,s=f.default(t,q),d=u.useLoader(n.TextureLoader,i);r.useLayoutEffect((function(){d.encoding=n.sRGBEncoding,d.wrapS=d.wrapT=n.RepeatWrapping}),[d]);var p=r.useMemo((function(){return new e.TextureEffect(l.default({},s,{texture:d||a}))}),[s,d,a]);return c.default.createElement("primitive",{ref:o,object:p,dispose:null})})),H=p(e.ToneMappingEffect),W=p(e.VignetteEffect),U=p(e.ShockWaveEffect),Y=["lut","tetrahedralInterpolation"],J=r.forwardRef((function(t,n){var o=t.lut,i=t.tetrahedralInterpolation,u=f.default(t,Y),a=r.useMemo((function(){return new e.LUTEffect(o,u)}),[o,u]);return r.useLayoutEffect((function(){o&&a.setLUT(o),i&&a.setTetrahedralInterpolationEnabled(i)}),[a,o,i]),c.default.createElement("primitive",{ref:n,object:a,dispose:null})}));exports.Bloom=h,exports.BrightnessContrast=E,exports.ChromaticAberration=x,exports.ColorAverage=g,exports.ColorDepth=b,exports.Depth=w,exports.DepthOfField=M,exports.DotScreen=R,exports.EffectComposer=y,exports.EffectComposerContext=S,exports.Glitch=A,exports.GodRays=T,exports.Grid=F,exports.HueSaturation=P,exports.LUT=J,exports.Noise=j,exports.Outline=D,exports.Pixelation=G,exports.SMAA=V,exports.SSAO=N,exports.Scanline=z,exports.SelectiveBloom=I,exports.Sepia=k,exports.ShockWave=U,exports.Texture=_,exports.ToneMapping=H,exports.Vignette=W;
